!function(a){"use strict";var b,c=function(c,d,e){var f=this,g=a(c),h={byPassKeys:[8,9,37,38,39,40],maskChars:{":":":","-":"-",".":"\\.","(":"\\(",")":"\\)","/":"/",",":",",_:"_"," ":"\\s","+":"\\+"},translationNumbers:{0:"\\d",1:"\\d",2:"\\d",3:"\\d",4:"\\d",5:"\\d",6:"\\d",7:"\\d",8:"\\d",9:"\\d"},translation:{A:"[a-zA-Z0-9]",S:"[a-zA-Z]"}};f.init=function(){f.settings={},e=e||{},h.translation=a.extend({},h.translation,h.translationNumbers),f.settings=a.extend(!0,{},h,e),f.settings.specialChars=a.extend({},f.settings.maskChars,f.settings.translation),g.each(function(){d=i.resolveMask(),d=i.fixRangeMask(d),g.attr("maxlength",d.length),g.attr("autocomplete","off"),i.destroyEvents(),i.setOnKeyUp(),i.setOnPaste()})};var i={onPasteMethod:function(){setTimeout(function(){g.trigger("keyup")},100)},setOnPaste:function(){i.hasOnSupport()?g.on("paste",i.onPasteMethod):(g=g.get(0),g.addEventListener?g.addEventListener("paste",i.onPasteMethod,!1):g.attachEvent("paste",i.onPasteMethod))},setOnKeyUp:function(){g.keyup(i.maskBehaviour).trigger("keyup")},hasOnSupport:function(){return a.isFunction(a().on)},destroyEvents:function(){g.unbind("keyup").unbind("onpaste")},resolveMask:function(){return"function"==typeof d?d(i.getVal(),b,e):d},setVal:function(a){return"input"===g.get(0).tagName.toLowerCase()?g.val(a):g.html(a),g},getVal:function(){return"input"===g.get(0).tagName.toLowerCase()?g.val():g.text()},specialChar:function(a,b){return f.settings.specialChars[a.charAt(b)]},maskChar:function(a,b){return f.settings.maskChars[a.charAt(b)]},maskBehaviour:function(b){b=b||window.event;var c=b.keyCode||b.which;if(a.inArray(c,f.settings.byPassKeys)>-1)return!0;var e=i.applyMask(d);return e!==i.getVal()&&i.setVal(e).trigger("change"),i.seekCallbacks(b,e)},applyMask:function(a){if(""!==i.getVal()){for(var f,b=function(a,b){for(;b<a.length;){if(void 0!==a[b])return!0;b++}return!1},c=function(b){b="string"==typeof b?b:b.join("");var c=b.match(new RegExp(i.maskToRegex(a)))||[];return c.shift(),c},d=i.getVal(),a=i.getMask(d,a),d=e.reverse?i.removeMaskChars(d):d,g=c(d);g.join("").length<i.removeMaskChars(d).length;)g=g.join("").split(""),d=i.removeMaskChars(g.join("")+d.substring(g.length+1)),a=i.getMask(d,a),g=c(d);for(var h=0;h<g.length;h++)if(f=i.specialChar(a,h),i.maskChar(a,h)&&b(g,h))g[h]=a.charAt(h);else if(f)if(void 0!==g[h]){if(null===g[h].match(new RegExp(f)))break}else if(null==="".match(new RegExp(f))){g=g.slice(0,h);break}return g.join("")}},getMask:function(a){var b=function(a){a=i.removeMaskChars(a);var b=0,c=0,e=0,f=d.length;for(b=f>=1?f:f-1,c=b;e<a.length;){for(;i.maskChar(d,c-1);)c--;c--,e++}return c=d.length>=1?c:c-1,d.substring(b,c)};return e.reverse?b(a):d},maskToRegex:function(a){for(var b,c=0,d="";c<a.length;c++)b=i.specialChar(a,c),b&&(d+="("+b+")?");return d},fixRangeMask:function(a){var b=function(a,b){return new Array(b+1).join(a)},c=/([A-Z0-9])\{(\d+)?,([(\d+)])\}/g;return a.replace(c,function(){var a=arguments,c=[],d=f.settings.translationNumbers[a[1]]?String.fromCharCode(parseInt("6"+a[1],16)):a[1].toLowerCase();return c[0]=a[1],c[1]=b(a[1],a[2]-1),c[2]=b(d,a[3]-a[2]).toLowerCase(),f.settings.specialChars[d]=i.specialChar(a[1])+"?",c.join("")})},removeMaskChars:function(b){return a.each(f.settings.maskChars,function(a){b=b.replace(new RegExp("("+f.settings.maskChars[a]+")?","g"),"")}),b},seekCallbacks:function(a,b){e.onKeyPress&&void 0===a.isTrigger&&"function"==typeof e.onKeyPress&&e.onKeyPress(b,a,g,e),e.onComplete&&void 0===a.isTrigger&&b.length===d.length&&"function"==typeof e.onComplete&&e.onComplete(b,a,g,e)}};"boolean"==typeof QUNIT&&(f.__p=i),f.remove=function(){i.destroyEvents(),i.setVal(i.removeMaskChars(i.getVal())),g.removeAttr("maxlength")},f.init()};a.fn.mask=function(b,d){return this.each(function(){a(this).data("mask",new c(this,b,d))})}}(window.jQuery||window.Zepto);