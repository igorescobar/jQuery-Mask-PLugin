a few changes to get the code smallest possible.
